import { RestrictedPropertySelector } from "../../../src/Autocompletition/PropertySelector/RestrictedPropertySelector";
import { createOntologyAssertionsFromTurtle } from "../../Utils/Utils";
import { nc, no } from "./OntologyObjectUtils";
import * as chai from 'chai';

describe("RestrictedPropertySelector", () => {
    it("should sort 1. testcase by topological order.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/restrictedPropertySelectorOntology1.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(0));
        chai.expect(orderConcepts).to.deep.equal([no([0]), no([4, 3, 2, 1])]);
    });

    it("should sort 2. testcase by topological order.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/restrictedPropertySelectorOntology2.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(0));
        chai.expect(orderConcepts).to.deep.equal([no([0]), no([1])]);
    });

    it("should sort 3. testcase by topological order.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/restrictedPropertySelectorOntology3.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(0));
        chai.expect(orderConcepts).to.deep.equal([no([0]), no([1]), no([2]), no([3]), no([4]), no([5]), no([6])]);
    });

    it("should sort 4. testcase by topological order.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/restrictedPropertySelectorOntology4.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(0));
        chai.expect(orderConcepts).to.deep.equal([no([0]), no([2]), no([4]), no([7])]);
    });

    it("should sort 5. testcase by topological order.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/restrictedPropertySelectorOntology5.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(0));
        chai.expect(orderConcepts).to.deep.equal([no([0]), no([6, 3, 2]), no([4, 5]), no([7])]);
    });

    it("should sort 6. testcase by topological order.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/restrictedPropertySelectorOntology6.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(0));
        chai.expect(orderConcepts).to.deep.equal([no([0]), no([3, 2, 1])]);
    });

    it("should sort 7. testcase by topological order.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/restrictedPropertySelectorOntology7.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(0));
        chai.expect(orderConcepts).to.deep.equal([no([0])]);
    });

    it("should not fail on non-existing ontology concept.", () => {
        var ontologyAssertions = createOntologyAssertionsFromTurtle(
            require("raw-loader!../../TestData/Autocompletition/PropertySelector/fullPropertySelectorOntology3.ttl")
        );

        var propertySelector = new RestrictedPropertySelector(ontologyAssertions);
        var orderConcepts = propertySelector.getPropertiesFor(nc(3));
        chai.expect(orderConcepts).to.deep.equal([]);
    });
});