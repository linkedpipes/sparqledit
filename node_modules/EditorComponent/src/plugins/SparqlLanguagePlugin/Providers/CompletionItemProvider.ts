import { SparqlAutocompleteProvider, SparqlLanguageServer } from "SparqlAutocompletion";

export class CompletionItemProvider implements monaco.languages.CompletionItemProvider {
    private sparqlLanguageServer: SparqlLanguageServer;

    constructor(sparqlLanguageServer: SparqlLanguageServer) {
        this.sparqlLanguageServer = sparqlLanguageServer;
    }

    triggerCharacters: string[] = [];

    provideCompletionItems(model: monaco.editor.IReadOnlyModel, position: monaco.Position): monaco.languages.CompletionItem[] {
        return this.sparqlLanguageServer
            .provideAutocompleteItems(model.getValue(), model.getOffsetAt(position))
            .map(x => ({
                label: x.label,
                insertText: x.insertText,
                kind: <any>x.kind,
                filterText: x.filterText
            }));
    }
}